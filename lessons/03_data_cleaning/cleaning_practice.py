import pandas as pd
import numpy as np


# 1. 練習用の「汚い」データを作成
data = {
    '日付': ['2026-01-01', '2026-01-01', '2026-01-02', '2026-01-03', '2026-01-03'],
    '商品': ['Tシャツ', 'Tシャツ', 'パーカー', 'ジーンズ', 'ジーンズ'],
    '売上': [2000, 2000, np.nan, 5000, 5000],  # np.nan は「空っぽ(欠損値)」
    '客層': ['大人', '大人', '子供', None, '大人'] # None も「空っぽ」
}

df = pd.DataFrame(data)

print("=== 元のデータ（汚れあり） ===")
print(df)
print("\n--- 欠損値の確認 ---")
print(df.isnull().sum()) # どこが空いているかカウント

# ---------------------------------------------------------
# ★お掃除1：重複データを取り除く
# 1行目と2行目が全く同じなので、1つにまとめます
# ---------------------------------------------------------
df = df.drop_duplicates()

# ---------------------------------------------------------
# ★お掃除2：欠損値（空欄）を埋める
# 「売上」が空っぽ(NaN)だと計算できないので、0で埋めてみます
# ---------------------------------------------------------
df['売上'] = df['売上'].fillna(0)

# ---------------------------------------------------------
# ★お掃除3：欠損値（空欄）がある行を消す
# 「客層」がわからないデータは分析に使えないので、その行ごと消します
# ---------------------------------------------------------
df = df.dropna(subset=['客層'])

print("\n=== お掃除後のデータ ===")
print(df)

# ---------------------------------------------------------
# 最後に合計を出してみる
# ---------------------------------------------------------
total_sales = df['売上'].sum()
print(f"\n本日の総売上： {total_sales}円")