import pandas as pd

# 1. 練習用の「ちょっと汚い」データを用意します
# 一部、データが抜けていたり（None）、バラバラな状態を再現
data = [
    {"件名": "A社システム開発", "金額": 500000, "ステータス": "完了"},
    {"件名": "B社保守費用", "金額": 15000, "ステータス": "完了"},
    {"件名": "C社サイト改修", "金額": 80000, "ステータス": None},  # 穴あき
    {"件名": "D社コンサル", "金額": 120000, "ステータス": "完了"},
    {"件名": "E社備品購入", "金額": 5000, "ステータス": "未対応"},
]

df = pd.DataFrame(data)

# 2. 【お掃除】穴あきデータ（NaN）を「不明」という文字で埋める
df["ステータス"] = df["ステータス"].fillna("不明")

# 3. 【絞り込み】金額が 50,000円 以上のデータだけを抽出する（高額案件リスト）
high_value_df = df[df["金額"] >= 50000]

# 4. 【並び替え】金額が高い順に並び替える
high_value_df = high_value_df.sort_values(by="金額", ascending=False)

# 5. 結果を保存
high_value_df.to_excel("high_value_invoices.xlsx", index=False)

print("クリーニングと高額案件の抽出が完了しました！")
print(high_value_df)